# 第一章：Web 服务内核 (Hello World)

> 现代互联网的基石是 Web 服务器。作为架构师，你的第一步是构建能够监听网络端口、响应客户端请求的核心服务，并确保它具备长期运行的能力。

## 本章目标

*   理解服务端程序的入口与生命周期概念。
*   熟悉启动日志与端口监听的基本流程。
*   建立“守护进程”运行方式的认知。

## 1. 启动监听 (Hello Server)

我们不使用现成的框架，而是从 `main` 函数开始，模拟一个 Web 服务器的启动过程。

```cangjie
// file: web_core.cj
import std.time.*

main() {
    println(">>> [CangjieWeb] 框架内核正在初始化...")

    // 模拟绑定端口
    let port = 8080
    println(">>> 正在监听端口: ${port}")
    println(">>> 服务启动成功！等待连接...")

    // 模拟服务器主循环
    while (true) {
        // 在真实场景中，这里会 accept() 一个 socket 连接
        // 为了演示，我们暂停一下模拟空转
        sleep(Duration.second * 5)
        println("... [Heartbeat] 服务运行中 ...")
    }
}
```

## 2. 编译与运行

```bash
cjc web_core.cj -o server
./server
```

虽然它现在还不能处理真正的 HTTP 请求，但它已经具备了作为一个守护进程（Daemon）的基本形态。这是所有高性能服务器的起点。

## 语言特性与应用解读

`import std.time.*` 展示了模块导入语法，常用的时间工具会在启动阶段参与心跳与监控。
`while (true)` 明确表达“持续运行”的服务生命周期，结合 `sleep(Duration.second * 5)` 可以避免空转占满 CPU。
使用 `let` 声明端口与版本等常量，让配置意图一目了然，防止误写。

## 工程化提示

*   真实服务需依赖标准网络库或框架，示例仅演示启动结构。
*   主循环应提供退出与健康检查机制，避免无控制的死循环。
*   日志中建议携带服务名称、端口与版本信息。

## 小试身手

1. 将端口号抽为常量，并在输出中标注环境（如 dev/prod）。
2. 在循环中加入简单的“请求计数”变量，观察它的增长。

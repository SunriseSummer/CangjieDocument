# ç¬¬åç« ï¼šå†³æˆ˜é­”ç‹ (ç»¼åˆå®æˆ˜)

> ç»ˆäºï¼Œä½ æ¥åˆ°äº†ç¬¬ 100 å±‚ã€‚é­”ç‹â€œBugâ€ç«¯ååœ¨ç‹åº§ä¹‹ä¸Šã€‚å®ƒæ‹¥æœ‰æ— ç©·çš„è¡€é‡å’Œå˜å¹»è«æµ‹çš„æ”»å‡»ã€‚ä½ éœ€è¦è¿ç”¨ä½ å­¦åˆ°çš„æ‰€æœ‰çŸ¥è¯†â€”â€”ç»“æ„ä½“ã€é›†åˆã€å¹¶å‘ã€ç­–ç•¥â€”â€”æ¥ç¼–å†™ä¸€ä¸ªè‡ªåŠ¨æˆ˜æ–—ç³»ç»Ÿå‡»è´¥å®ƒï¼Œå¹¶æŒç»­è®°å½•å…³é”®æˆ˜æ–—æŒ‡æ ‡ã€‚

## æœ¬ç« ç›®æ ‡

*   ç»¼åˆè¿ç”¨å¹¶å‘ã€é›†åˆä¸ç»“æ„ä½“æ„å»ºå®Œæ•´åœºæ™¯ã€‚
*   ç†è§£å…±äº«çŠ¶æ€çš„åŒæ­¥ç­–ç•¥ä¸æ—¥å¿—è®°å½•æ–¹å¼ã€‚
*   ä½“éªŒä»â€œæ¨¡å‹è®¾è®¡â€åˆ°â€œæµç¨‹ç¼–æ’â€çš„å®Œæ•´é—­ç¯ã€‚

## 1. æˆ˜åœºæ¨¡æ‹Ÿç³»ç»Ÿ

æˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿä¸€åœºå®å¤§çš„ Boss æˆ˜ã€‚
*   **Boss**: æ‹¥æœ‰æµ·é‡ HPï¼Œä¼šéšæœºé‡Šæ”¾æŠ€èƒ½ã€‚
*   **Hero Party**: ä¸€ä¸ªè‹±é›„å°é˜Ÿï¼Œå¹¶å‘è¿›è¡Œæ”»å‡»ã€‚
*   **Log System**: è®°å½•æˆ˜æ–—æ—¥å¿—ã€‚

```cangjie
import std.sync.*
import std.time.*
import std.collection.*
import std.math.* // å‡è®¾æœ‰éšæœºæ•°åº“ï¼Œè¿™é‡Œç”¨æ¨¡æ‹Ÿ

// === 1. å®ä½“å®šä¹‰ ===

class Boss {
    let name: String
    var hp: AtomicInt64 // çº¿ç¨‹å®‰å…¨çš„è¡€é‡

    public init(name: String, maxHp: Int64) {
        this.name = name
        this.hp = AtomicInt64(maxHp)
    }

    public func takeDamage(amount: Int64) {
        let current = hp.fetchSub(amount)
        if (current > 0) {
            // ç®€å•çš„è¡€é‡æ¡æ‰“å°é€»è¾‘ (æ¨¡æ‹Ÿ)
            // print("Boss å—ä¼¤: -${amount}\n")
        }
    }

    public func isDead(): Bool {
        return hp.load() <= 0
    }
}

struct Skill {
    let name: String
    let damage: Int64
    let castTime: Int64 // æ¯«ç§’
}

// === 2. è‹±é›„è¡Œä¸º (å¹¶å‘ä»»åŠ¡) ===

func heroAction(name: String, boss: Boss, skills: Array<Skill>) {
    while (!boss.isDead()) {
        // ç®€å•æ¨¡æ‹Ÿéšæœºé€‰æ‹©æŠ€èƒ½ (è¿™é‡Œå›ºå®šè½®è¯¢)
        for (skill in skills) {
            if (boss.isDead()) { break }

            // æ¨¡æ‹ŸåŸå”±
            sleep(Duration.millisecond * skill.castTime)

            // é€ æˆä¼¤å®³
            boss.takeDamage(skill.damage)
            println("âš”ï¸ [${name}] é‡Šæ”¾äº† [${skill.name}]! Boss å‰©ä½™ HP: ${boss.hp.load()}")

            // æ¨¡æ‹ŸæŠ€èƒ½å†·å´
            sleep(Duration.millisecond * 200)
        }
    }
    println("ğŸ† [${name}] åœæ­¢æ”»å‡»ï¼Œèƒœåˆ©åœ¨æœ›ï¼")
}

// === 3. æˆ˜æ–—ä¸»å¾ªç¯ ===

main() {
    println("ğŸ”¥ æœ€ç»ˆå†³æˆ˜å¼€å§‹ï¼æŒ‘æˆ˜é­”ç‹ Bug ğŸ”¥")

    let demonLord = Boss("é­”ç‹ Bug", 5000)

    // å®šä¹‰æŠ€èƒ½åº“
    let warriorSkills = [Skill("çƒˆç«å‰‘", 150, 500), Skill("æ—‹é£æ–©", 100, 300)]
    let mageSkills = [Skill("ç‚çˆ†", 300, 1000), Skill("å†°æª", 80, 200)]

    // ç»„å»ºå°é˜Ÿ (å¹¶å‘)
    let partyFutures = ArrayList<Future<Unit>>()

    // æˆ˜å£«è¿›åœº
    partyFutures.append(spawn { heroAction("äºšç‘Ÿ", demonLord, warriorSkills) })

    // æ³•å¸ˆè¿›åœº
    partyFutures.append(spawn { heroAction("æ¢…æ—", demonLord, mageSkills) })

    // å°„æ‰‹è¿›åœº
    partyFutures.append(spawn {
        heroAction("ç½—å®¾", demonLord, [Skill("è¿å°„", 50, 100)])
    })

    // ç›‘æ§æˆ˜æ–—
    while (!demonLord.isDead()) {
        sleep(Duration.second)
        println("... æˆ˜æ–—æ¿€çƒˆè¿›è¡Œä¸­ ...")
    }

    // ç­‰å¾…æ‰€æœ‰è‹±é›„æ”¶åˆ€
    for (f in partyFutures) { f.get() }

    println("\nğŸ†ğŸ†ğŸ† æ­å–œï¼é­”ç‹å·²è¢«å‡»è´¥ï¼ ğŸ†ğŸ†ğŸ†")
    println("ä½ å·²æˆåŠŸç™»é¡¶ä»“é¢‰é­”å¡”ã€‚")
    println("ä½†è¿™åªæ˜¯å¼€å§‹ï¼Œæ›´å¹¿é˜”çš„ç¼–ç¨‹ä¸–ç•Œåœ¨ç­‰ç€ä½ ã€‚")
}
```

## ç»ˆç« ï¼šæ–°çš„æ—…é€”

ä½ çœ‹ç€é­”ç‹å€’ä¸‹ï¼Œæ‰‹ä¸­çš„ä»£ç æ³•æ–å‘å‡ºäº†è€€çœ¼çš„å…‰èŠ’ã€‚
ä½ ä¸å†æ˜¯é‚£ä¸ªç«™åœ¨å¡”åº•çš„æ‡µæ‡‚æ–°æ‰‹ï¼Œä½ å·²ç»æŒæ¡äº†ï¼š
*   **å˜é‡ä¸ç±»å‹** (å±æ€§)
*   **æµç¨‹æ§åˆ¶** (æˆ˜æœ¯)
*   **å‡½æ•°ä¸ç±»** (æ³•æœ¯ä¸è£…å¤‡)
*   **é›†åˆä¸æ³›å‹** (å›¾é‰´)
*   **å¹¶å‘ç¼–ç¨‹** (åˆ†èº«æœ¯)

å¸¦ä¸Šè¿™ä»½æ™ºæ…§ï¼Œå»åˆ›é€ å±äºä½ çš„ä¸–ç•Œå§ï¼

## å·¥ç¨‹åŒ–æç¤º

*   å®é™…æˆ˜æ–—ç³»ç»Ÿä¼šæœ‰æ›´å¤æ‚çš„çŠ¶æ€æœºä¸ä¼¤å®³è®¡ç®—ï¼Œæœ¬ä¾‹ä»…ç¤ºæ„æµç¨‹ã€‚
*   å¹¶å‘å†™æ—¥å¿—å®¹æ˜“äº§ç”Ÿäº¤é”™è¾“å‡ºï¼Œå»ºè®®ä½¿ç”¨ç»Ÿä¸€çš„æ—¥å¿—ç®¡é“ã€‚
*   éšæœºæ•°ã€æŠ€èƒ½å†·å´ç­‰ä¾èµ–åº“éœ€ä»¥æ ‡å‡†åº“å®ç°ä¸ºå‡†ã€‚

## å°è¯•èº«æ‰‹

1. ä¸º `Boss` å¢åŠ é˜¶æ®µçŠ¶æ€ï¼ˆå¦‚ 70%/30% è¡€é‡è§¦å‘æ–°æŠ€èƒ½ï¼‰ã€‚
2. å°†è‹±é›„æŠ€èƒ½åˆ—è¡¨æŠ½å–ä¸ºé…ç½®ç»“æ„ï¼Œå¹¶åœ¨ä¸»æµç¨‹ä¸­åŠ è½½ã€‚
